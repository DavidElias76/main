<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Information Management System (SIMS)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #868788;
      margin: 0;
      padding: 0;
      display: flex;
      min-height: 200vh;
    }
    .container {
      display: flex;
      flex-direction: row;
      width: 100%;
    }
    nav {
      width: 20%;
      background-color: #ddd;
      padding: 20px;
      box-sizing: border-box;
      border-right: 1px solid #ddd;
    }
    nav ul {
      list-style: none;
      padding: 0;
    }
    nav ul li {
      margin-bottom: 10px;
    }
    nav ul li a {
      text-decoration: none;
      color: #007bff;
      font-size: 18px;
      padding: 10px;
      border: 1px solid #007bff;
      border-radius: 4px;
      display: block;
    }
    nav ul li a:hover {
      background-color: #007bff;
      color: white;
    }
    .content {
      width: 80%;
      padding: 20px;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, select, button {
      padding: 10px;
      font-size: 16px;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table th, table td {
      padding: 10px;
      border: 1px solid #ddd;
    }
    table th {
      background-color: #f0f0f0;
    }
    .students-section, .add-student-form, .grades-section, .courses-section {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Navigation Bar -->
    <nav>
      <h2>Menu</h2>
      <ul>
        <li><a href="#" onclick="showSection('add-student')">Add Students</a></li>
        <li><a href="#" onclick="showSection('courses')">Add Units</a></li>
        <li><a href="#" onclick="showSection('grades')">Add/Manage Grades</a></li>
        <li><a href="#" onclick="showSection('students')">Manage Students</a></li>
        <li><a href="login.html">Logout</a></li>
      </ul>
    </nav>

    <!-- Content Section -->
    <div class="content">
      <h1>Student Information Management System (SIMS)</h1>

      <!-- Add Student Form -->
      <div id="add-student-form" class="add-student-form">
        <h2>Add/Edit Student</h2>
        <form id="student-input">
          <label>Name:</label>
          <input type="text" id="student-name" required />
          <label>Date of Birth:</label>
          <input type="date" id="student-dob" required />
          <label>Contact:</label>
          <input type="text" id="student-contact" required />
          <label>Email:</label>
          <input type="email" id="student-email" required />
          <label>Department:</label>
          <select id="student-department" required>
            <option value="">Select Department</option>
            <option value="School of Business">School of Business</option>
            <option value="School of Technology">School of Technology</option>
            <option value="School of Education">School of Education</option>
            <option value="Arts & Social Sciences">Arts & Social Sciences</option>
          </select>
          <label>Course Program:</label>
          <select id="student-program" required>
            <option value="">Select Program</option>
            <option value="BCOM">Bachelor of Commerce (BCOM)</option>
            <option value="BBIT">Bachelor of Business Information Technology (BBIT)</option>
            <option value="BIT">Bachelor of Information Technology (BIT)</option>
            <option value="BAC">Bachelor of Accounting (BAC)</option>
            <option value="BSD">Bachelor of Software Development (BSD)</option>
          </select>
          <label>Semester:</label>
          <select id="student-semester" required>
            <option value="">Select Semester</option>
            <option value="JAN-APRIL">JAN-APRIL</option>
            <option value="MAY-AUG">MAY-AUG</option>
            <option value="SEPT-DEC">SEPT-DEC</option>
          </select>
          <button type="submit">Add Student</button>
        </form>
      </div>

      <!-- Manage Courses Section -->
      <div id="courses-section" class="courses-section">
        <h2>Course Registration</h2>
        <label>Select Student:</label>
        <select id="student-selector" onchange="loadStudentUnits()" style="width: 200px; margin-left: 1rem; margin-right: 1rem;">
          <option value="">Select a Student</option>
        </select>
        <label style="margin-bottom: 20px;">Select Units (Minimum 7):</label><br>
        <select id="unit-dropdown" multiple style="width: 400px; height: 200px;">
          <option value="BBIT 02201">BBIT 02201 (Database Design)</option>
          <option value="BBIT 02202">BBIT 02202 (Probability)</option>
          <option value="BBIT 02203">BBIT 02203 (Mobile Apps)</option>
          <option value="BBIT 02204">BBIT 02204 (Business Finance)</option>
          <option value="BBIT 02205">BBIT 02205 (E-Commerce)</option>
          <option value="BBIT 02206">BBIT 02206 (Accounting II)</option>
          <option value="BBIT 02207">BBIT 02207 (Knowledge Mgmt)</option>
          <option value="BBIT 02104">BBIT 02104 (Application programming)</option>
          <option value="BBIT 02105">BBIT 02105 (Internet Applications Programming)</option>
          <option value="BBIT 02103">BBIT 02103 (Object - Oriented Technologies)</option>
        </select><br>
        <button onclick="addSelectedUnits()" style="margin-top: 3rem;">Add Selected Units</button>
        <h3>Registered Units</h3>
        <table id="units-table">
          <thead>
            <tr>
              <th>Unit Code</th>
              <th>Unit Name</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="units-table-body"></tbody>
        </table>
      </div>

      <!-- Registered Students Section -->
      <div id="students-section" class="students-section">
        <h2>Registered Students</h2>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>DOB</th>
              <th>Contact</th>
              <th>Email</th>
              <th>Department</th>
              <th>Program</th>
              <th>Semester</th>
              <th>Units</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="students-table-body"></tbody>
        </table>
      </div>

      <!-- Manage Grades Section -->
      <div id="grades-section" class="grades-section">
        <h2>Manage Grades</h2>
        <label>Select Student:</label>
        <select id="grade-student-selector" onchange="loadGradesForm()" style="width: 200px;">
          <option value="">Select a Student</option>
        </select>
        <form id="grades-form" style="display: none;">
          <h3>Record Grades</h3>
          <div id="grades-inputs"></div>
          <button type="submit">Save Grades</button>
        </form>
        <h3>Grade Report</h3>
        <table id="grades-table">
          <thead>
            <tr>
              <th>Unit Code</th>
              <th>Unit Name</th>
              <th>Grade</th>
            </tr>
          </thead>
          <tbody id="grades-table-body"></tbody>
        </table>
        <button onclick="printReport()" style="margin-top: 20px; background-color: orange;">Print Report</button>
      </div>
    </div>
  </div>

  <script>
    let registeredStudents = [];
    let currentUnits = [];
    let editingStudentIndex = null;

    // Populate student selectors
    function updateStudentSelectors() {
      const courseSelector = document.getElementById('student-selector');
      const gradeSelector = document.getElementById('grade-student-selector');
      courseSelector.innerHTML = '<option value="">Select a Student</option>';
      gradeSelector.innerHTML = '<option value="">Select a Student</option>';
      registeredStudents.forEach((student, index) => {
        const option = `<option value="${index}">${student.name}</option>`;
        courseSelector.innerHTML += option;
        gradeSelector.innerHTML += option;
      });
    }

    // Add selected units to the selected student (minimum 7)
    function addSelectedUnits() {
      const unitDropdown = document.getElementById('unit-dropdown');
      const studentIndex = document.getElementById('student-selector').value;
      const selectedOptions = Array.from(unitDropdown.selectedOptions).map(option => ({
        code: option.value.split(" ")[0],
        name: option.text,
      }));

      if (studentIndex === "") {
        alert('Please select a student first.');
        return;
      }

      if (selectedOptions.length < 7) {
        alert('Please select at least 7 units.');
        return;
      }

      const student = registeredStudents[studentIndex];
      student.units = selectedOptions;
      currentUnits = selectedOptions;
      updateUnitsTable();
      alert(`Units updated for ${student.name}.`);
      unitDropdown.value = null;
    }

    // Load selected student's units
    function loadStudentUnits() {
      const studentIndex = document.getElementById('student-selector').value;
      if (studentIndex !== "") {
        currentUnits = registeredStudents[studentIndex].units || [];
        updateUnitsTable();
      } else {
        currentUnits = [];
        updateUnitsTable();
      }
    }

    // Update the units table
    function updateUnitsTable() {
      const tableBody = document.getElementById('units-table-body');
      tableBody.innerHTML = '';
      currentUnits.forEach((unit, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${unit.code}</td>
          <td>${unit.name}</td>
          <td><button style="background-color: red; color: white; border: none; padding: 5px 10px; cursor: pointer;" onclick="removeUnit(${index})">Remove</button></td>
        `;
        tableBody.appendChild(row);
      });
    }

    // Remove a unit
    function removeUnit(index) {
      const studentIndex = document.getElementById('student-selector').value;
      if (studentIndex !== "") {
        currentUnits.splice(index, 1);
        if (currentUnits.length < 7) {
          alert('Minimum of 7 units required. Please add more units.');
        }
        registeredStudents[studentIndex].units = currentUnits;
        updateUnitsTable();
      }
    }

    // Update the students table
    function updateStudentsTable() {
      const tableBody = document.getElementById('students-table-body');
      tableBody.innerHTML = '';
      registeredStudents.forEach((student, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${student.name}</td>
          <td>${student.dob}</td>
          <td>${student.contact}</td>
          <td>${student.email}</td>
          <td>${student.department}</td>
          <td>${student.program}</td>
          <td>${student.semester}</td>
          <td>${student.units.length}</td>
          <td>
            <button style="background-color: green; color: white; border: none; padding: 5px 10px; cursor: pointer;" onclick="editStudent(${index})">Edit</button>
            <button style="background-color: red; color: white; border: none; padding: 5px 10px; cursor: pointer;" onclick="removeStudent(${index})">Delete</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    // Edit a student
    function editStudent(index) {
      const student = registeredStudents[index];
      document.getElementById('student-name').value = student.name;
      document.getElementById('student-dob').value = student.dob;
      document.getElementById('student-contact').value = student.contact;
      document.getElementById('student-email').value = student.email;
      document.getElementById('student-department').value = student.department;
      document.getElementById('student-program').value = student.program;
      document.getElementById('student-semester').value = student.semester;
      editingStudentIndex = index;
      showSection('add-student');
    }

    // Remove a student
    function removeStudent(index) {
      registeredStudents.splice(index, 1);
      updateStudentsTable();
      updateStudentSelectors();
    }

    // Load grades form for selected student
    function loadGradesForm() {
      const studentIndex = document.getElementById('grade-student-selector').value;
      const form = document.getElementById('grades-form');
      const inputsDiv = document.getElementById('grades-inputs');
      inputsDiv.innerHTML = '';
      
      if (studentIndex !== "") {
        const student = registeredStudents[studentIndex];
        form.style.display = 'block';
        student.units.forEach((unit, index) => {
          const label = document.createElement('label');
          label.textContent = `${unit.name}: `;
          const input = document.createElement('input');
          input.type = 'text';
          input.id = `grade-${index}`;
          input.value = student.grades && student.grades[unit.code] ? student.grades[unit.code] : '';
          inputsDiv.appendChild(label);
          inputsDiv.appendChild(input);
          inputsDiv.appendChild(document.createElement('br'));
        });
        updateGradesTable(student);
      } else {
        form.style.display = 'none';
        document.getElementById('grades-table-body').innerHTML = '';
      }
    }

    // Save grades
    document.getElementById('grades-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const studentIndex = document.getElementById('grade-student-selector').value;
      const student = registeredStudents[studentIndex];
      student.grades = student.grades || {};
      student.units.forEach((unit, index) => {
        student.grades[unit.code] = document.getElementById(`grade-${index}`).value;
      });
      alert(`Grades saved for ${student.name}.`);
      updateGradesTable(student);
    });

    // Update grades table
    function updateGradesTable(student) {
      const tableBody = document.getElementById('grades-table-body');
      tableBody.innerHTML = '';
      if (student && student.units) {
        student.units.forEach(unit => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${unit.code}</td>
            <td>${unit.name}</td>
            <td>${student.grades && student.grades[unit.code] ? student.grades[unit.code] : 'N/A'}</td>
          `;
          tableBody.appendChild(row);
        });
      }
    }

    // Print report
    function printReport() {
      const studentIndex = document.getElementById('grade-student-selector').value;
      if (studentIndex === "") {
        alert('Please select a student to print their report.');
        return;
      }
      const student = registeredStudents[studentIndex];
      let report = `Student Information Report\n`;
      report += `Name: ${student.name}\n`;
      report += `DOB: ${student.dob}\n`;
      report += `Contact: ${student.contact}\n`;
      report += `Email: ${student.email}\n`;
      report += `Department: ${student.department}\n`;
      report += `Program: ${student.program}\n`;
      report += `Semester: ${student.semester}\n\n`;
      report += `Registered Units (${student.units.length}):\n`;
      student.units.forEach(unit => {
        report += `${unit.code} - ${unit.name}\n`;
      });
      report += `\nGrades:\n`;
      student.units.forEach(unit => {
        report += `${unit.code} - ${unit.name}: ${student.grades && student.grades[unit.code] ? student.grades[unit.code] : 'N/A'}\n`;
      });

      const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `${student.name}_report.txt`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Show a specific section
    function showSection(sectionId) {
      document.querySelectorAll('.students-section, .add-student-form, .grades-section, .courses-section').forEach((section) => {
        section.style.display = 'none';
      });
      if (sectionId === 'add-student') {
        document.getElementById('add-student-form').style.display = 'block';
      } else if (sectionId === 'courses') {
        document.getElementById('courses-section').style.display = 'block';
        updateStudentSelectors();
        loadStudentUnits();
      } else if (sectionId === 'students') {
        document.getElementById('students-section').style.display = 'block';
        updateStudentsTable();
      } else if (sectionId === 'grades') {
        document.getElementById('grades-section').style.display = 'block';
        updateStudentSelectors();
        loadGradesForm();
      }
    }

    // Handle form submission for adding/editing a student
    const originalSubmit = (e) => {
      e.preventDefault();
      const student = {
        name: document.getElementById('student-name').value,
        dob: document.getElementById('student-dob').value,
        contact: document.getElementById('student-contact').value,
        email: document.getElementById('student-email').value,
        department: document.getElementById('student-department').value,
        program: document.getElementById('student-program').value,
        semester: document.getElementById('student-semester').value,
        units: [],
        grades: {}
      };
      registeredStudents.push(student);
      document.getElementById('student-input').reset();
      updateStudentSelectors();
      alert('Student added. Now select their courses.');
      showSection('courses');
    };

    document.getElementById('student-input').addEventListener('submit', (e) => {
      e.preventDefault();
      if (editingStudentIndex !== null) {
        registeredStudents[editingStudentIndex] = {
          name: document.getElementById('student-name').value,
          dob: document.getElementById('student-dob').value,
          contact: document.getElementById('student-contact').value,
          email: document.getElementById('student-email').value,
          department: document.getElementById('student-department').value,
          program: document.getElementById('student-program').value,
          semester: document.getElementById('student-semester').value,
          units: registeredStudents[editingStudentIndex].units,
          grades: registeredStudents[editingStudentIndex].grades || {}
        };
        alert('Student updated.');
        editingStudentIndex = null;
        document.getElementById('student-input').reset();
        showSection('students');
      } else {
        originalSubmit(e);
      }
      updateStudentSelectors();
    });

    // Initial setup
    document.getElementById('add-student-form').style.display = 'block';
  </script>
</body>
</html>